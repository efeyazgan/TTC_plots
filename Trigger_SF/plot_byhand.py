import ROOT
import sys
from ROOT import TFile, TH1F, TH2D, TCanvas, TLegend, TPad, TEfficiency
import numpy as np

import CMSTDRStyle
CMSTDRStyle.setTDRStyle().cd()
import CMSstyle
from array import array

tdlepetabin=array('d',[0,0.4,0.9,1.5,2.5])
tdl1ptbin=array('d',[20,40,50,65,80,100,200])
tdl2ptbin=array('d',[20,40,50,65,80,100,200])

ee_l1pteta = TH2D('h2D_SF_ee_lep1pteta', 'h2D_SF_ee_lep2pteta', 6, tdl1ptbin, 4, tdlepetabin)
ee_l1pteta.Sumw2()
ee_l1pteta.SetStats(0)
ee_l1pteta.GetXaxis().SetTitle('Leading Lepton P_{T} [GeV]')
ee_l1pteta.GetYaxis().SetTitle('Leading Lepton #||{#eta}')
ee_l1pteta.SetTitle('')

ee_l2pteta = TH2D('h2D_SF_ee_lep2pteta','h2D_SF_ee_lep2pteta',6,tdl2ptbin,4,tdlepetabin)
ee_l2pteta.Sumw2()
ee_l2pteta.GetXaxis().SetTitle('Subleading Lepton P_{T} [GeV]')
ee_l2pteta.GetYaxis().SetTitle('Subleading Lepton #||{#eta}')
ee_l2pteta.SetStats(0)
ee_l2pteta.SetTitle('')

ee_l1pteta.SetBinContent(1,1,0.936)
ee_l1pteta.SetBinContent(2,1,0.967)
ee_l1pteta.SetBinContent(3,1,0.985)
ee_l1pteta.SetBinContent(4,1,0.984)
ee_l1pteta.SetBinContent(5,1,0.987)
ee_l1pteta.SetBinContent(6,1,0.988)
ee_l1pteta.SetBinContent(1,2,0.969)
ee_l1pteta.SetBinContent(2,2,0.972)
ee_l1pteta.SetBinContent(3,2,0.986)
ee_l1pteta.SetBinContent(4,2,1.002)
ee_l1pteta.SetBinContent(5,2,0.988)
ee_l1pteta.SetBinContent(6,2,0.996)
ee_l1pteta.SetBinContent(1,3,1.020)
ee_l1pteta.SetBinContent(2,3,0.999)
ee_l1pteta.SetBinContent(3,3,0.969)
ee_l1pteta.SetBinContent(4,3,0.975)
ee_l1pteta.SetBinContent(5,3,0.951)
ee_l1pteta.SetBinContent(6,3,0.992)
ee_l1pteta.SetBinContent(1,4,0.906)
ee_l1pteta.SetBinContent(2,4,0.986)
ee_l1pteta.SetBinContent(3,4,1.001)
ee_l1pteta.SetBinContent(4,4,0.997)
ee_l1pteta.SetBinContent(5,4,1.005)
ee_l1pteta.SetBinContent(6,4,0.980)

ee_l1pteta.SetBinError(1,1,0.046)
ee_l1pteta.SetBinError(2,1,0.019)
ee_l1pteta.SetBinError(3,1,0.012)
ee_l1pteta.SetBinError(4,1,0.010)
ee_l1pteta.SetBinError(5,1,0.007)
ee_l1pteta.SetBinError(6,1,0.009)
ee_l1pteta.SetBinError(1,2,0.025)
ee_l1pteta.SetBinError(2,2,0.016)
ee_l1pteta.SetBinError(3,2,0.007)
ee_l1pteta.SetBinError(4,2,0.012)
ee_l1pteta.SetBinError(5,2,0.025)
ee_l1pteta.SetBinError(6,2,0.006)
ee_l1pteta.SetBinError(1,3,0.083)
ee_l1pteta.SetBinError(2,3,0.022)
ee_l1pteta.SetBinError(3,3,0.019)
ee_l1pteta.SetBinError(4,3,0.017)
ee_l1pteta.SetBinError(5,3,0.011)
ee_l1pteta.SetBinError(6,3,0.009)
ee_l1pteta.SetBinError(1,4,0.069)
ee_l1pteta.SetBinError(2,4,0.028)
ee_l1pteta.SetBinError(3,4,0.017)
ee_l1pteta.SetBinError(4,4,0.022)
ee_l1pteta.SetBinError(5,4,0.018)
ee_l1pteta.SetBinError(6,4,0.020)

ee_l2pteta.SetBinContent(1,1,0.984)
ee_l2pteta.SetBinContent(2,1,0.985)
ee_l2pteta.SetBinContent(3,1,0.987)
ee_l2pteta.SetBinContent(4,1,0.987)
ee_l2pteta.SetBinContent(5,1,0.987)
ee_l2pteta.SetBinContent(6,1,0.996)
ee_l2pteta.SetBinContent(1,2,0.992)
ee_l2pteta.SetBinContent(2,2,0.986)
ee_l2pteta.SetBinContent(3,2,0.988)
ee_l2pteta.SetBinContent(4,2,0.997)
ee_l2pteta.SetBinContent(5,2,0.999)
ee_l2pteta.SetBinContent(6,2,0.984)
ee_l2pteta.SetBinContent(1,3,0.974)
ee_l2pteta.SetBinContent(2,3,0.994)
ee_l2pteta.SetBinContent(3,3,0.981)
ee_l2pteta.SetBinContent(4,3,0.998)
ee_l2pteta.SetBinContent(5,3,1.004)
ee_l2pteta.SetBinContent(6,3,0.982)
ee_l2pteta.SetBinContent(1,4,0.977)
ee_l2pteta.SetBinContent(2,4,0.999)
ee_l2pteta.SetBinContent(3,4,0.970)
ee_l2pteta.SetBinContent(4,4,0.989)
ee_l2pteta.SetBinContent(5,4,1.000)
ee_l2pteta.SetBinContent(6,4,1.000)

ee_l2pteta.SetBinError(1,1,0.007)
ee_l2pteta.SetBinError(2,1,0.012)
ee_l2pteta.SetBinError(3,1,0.008)
ee_l2pteta.SetBinError(4,1,0.019)
ee_l2pteta.SetBinError(5,1,0.019)
ee_l2pteta.SetBinError(6,1,0.004)
ee_l2pteta.SetBinError(1,2,0.009)
ee_l2pteta.SetBinError(2,2,0.014)
ee_l2pteta.SetBinError(3,2,0.004)
ee_l2pteta.SetBinError(4,2,0.007)
ee_l2pteta.SetBinError(5,2,0.006)
ee_l2pteta.SetBinError(6,2,0.012)
ee_l2pteta.SetBinError(1,3,0.013)
ee_l2pteta.SetBinError(2,3,0.008)
ee_l2pteta.SetBinError(3,3,0.022)
ee_l2pteta.SetBinError(4,3,0.008)
ee_l2pteta.SetBinError(5,3,0.004)
ee_l2pteta.SetBinError(6,3,0.009)
ee_l2pteta.SetBinError(1,4,0.008)
ee_l2pteta.SetBinError(2,4,0.018)
ee_l2pteta.SetBinError(3,4,0.015)
ee_l2pteta.SetBinError(4,4,0.031)
ee_l2pteta.SetBinError(5,4,0.002)
ee_l2pteta.SetBinError(6,4,0.003)

em_l1pteta = TH2D('h2D_SF_emu_lep1pteta', 'h2D_SF_emu_lep1pteta', 6, tdl1ptbin, 4, tdlepetabin)
em_l1pteta.Sumw2()
em_l1pteta.SetStats(0)
em_l1pteta.GetXaxis().SetTitle('Muon P_{T} [GeV]')
em_l1pteta.GetYaxis().SetTitle('Muon #||{#eta}')
em_l1pteta.SetTitle('')

em_l2pteta = TH2D('h2D_SF_emu_lep2pteta','h2D_SF_emu_lep2pteta', 6,tdl1ptbin,4,tdlepetabin)
em_l2pteta.Sumw2()
em_l2pteta.GetXaxis().SetTitle('Electron P_{T} [GeV]')
em_l2pteta.GetYaxis().SetTitle('Electron #||{#eta}')
em_l2pteta.SetStats(0)
em_l2pteta.SetTitle('')

em_l1pteta.SetBinContent(1,1,0.986)
em_l1pteta.SetBinContent(2,1,1.000)
em_l1pteta.SetBinContent(3,1,0.990)
em_l1pteta.SetBinContent(4,1,0.996)
em_l1pteta.SetBinContent(5,1,0.991)
em_l1pteta.SetBinContent(6,1,0.991)
em_l1pteta.SetBinContent(1,2,0.987)
em_l1pteta.SetBinContent(2,2,0.990)
em_l1pteta.SetBinContent(3,2,0.990)
em_l1pteta.SetBinContent(4,2,0.995)
em_l1pteta.SetBinContent(5,2,0.997)
em_l1pteta.SetBinContent(6,2,0.984)
em_l1pteta.SetBinContent(1,3,0.989)
em_l1pteta.SetBinContent(2,3,0.993)
em_l1pteta.SetBinContent(3,3,0.990)
em_l1pteta.SetBinContent(4,3,0.993)
em_l1pteta.SetBinContent(5,3,0.996)
em_l1pteta.SetBinContent(6,3,0.992)
em_l1pteta.SetBinContent(1,4,0.989)
em_l1pteta.SetBinContent(2,4,0.999)
em_l1pteta.SetBinContent(3,4,0.997)
em_l1pteta.SetBinContent(4,4,1.013)
em_l1pteta.SetBinContent(5,4,0.988)
em_l1pteta.SetBinContent(6,4,0.991)

em_l1pteta.SetBinError(1,1,0.008)
em_l1pteta.SetBinError(2,1,0.007)
em_l1pteta.SetBinError(3,1,0.009)
em_l1pteta.SetBinError(4,1,0.002)
em_l1pteta.SetBinError(5,1,0.006)
em_l1pteta.SetBinError(6,1,0.008)
em_l1pteta.SetBinError(1,2,0.007)
em_l1pteta.SetBinError(2,2,0.013)
em_l1pteta.SetBinError(3,2,0.006)
em_l1pteta.SetBinError(4,2,0.004)
em_l1pteta.SetBinError(5,2,0.009)
em_l1pteta.SetBinError(6,2,0.009)
em_l1pteta.SetBinError(1,3,0.010)
em_l1pteta.SetBinError(2,3,0.010)
em_l1pteta.SetBinError(3,3,0.009)
em_l1pteta.SetBinError(4,3,0.008)
em_l1pteta.SetBinError(5,3,0.014)
em_l1pteta.SetBinError(6,3,0.010)
em_l1pteta.SetBinError(1,4,0.003)
em_l1pteta.SetBinError(2,4,0.011)
em_l1pteta.SetBinError(3,4,0.003)
em_l1pteta.SetBinError(4,4,0.022)
em_l1pteta.SetBinError(5,4,0.002)
em_l1pteta.SetBinError(6,4,0.007)

em_l2pteta.SetBinContent(1,1,0.990)
em_l2pteta.SetBinContent(2,1,0.986)
em_l2pteta.SetBinContent(3,1,0.997)
em_l2pteta.SetBinContent(4,1,0.997)
em_l2pteta.SetBinContent(5,1,1.003)
em_l2pteta.SetBinContent(6,1,0.995)
em_l2pteta.SetBinContent(1,2,0.983)
em_l2pteta.SetBinContent(2,2,0.997)
em_l2pteta.SetBinContent(3,2,0.993)
em_l2pteta.SetBinContent(4,2,0.992)
em_l2pteta.SetBinContent(5,2,1.000)
em_l2pteta.SetBinContent(6,2,0.998)
em_l2pteta.SetBinContent(1,3,0.974)
em_l2pteta.SetBinContent(2,3,0.988)
em_l2pteta.SetBinContent(3,3,0.997)
em_l2pteta.SetBinContent(4,3,0.997)
em_l2pteta.SetBinContent(5,3,0.991)
em_l2pteta.SetBinContent(6,3,0.994)
em_l2pteta.SetBinContent(1,4,0.978)
em_l2pteta.SetBinContent(2,4,0.990)
em_l2pteta.SetBinContent(3,4,0.990)
em_l2pteta.SetBinContent(4,4,0.990)
em_l2pteta.SetBinContent(5,4,0.984)
em_l2pteta.SetBinContent(6,4,0.991)

em_l2pteta.SetBinError(1,1,0.007)
em_l2pteta.SetBinError(2,1,0.013)
em_l2pteta.SetBinError(3,1,0.003)
em_l2pteta.SetBinError(4,1,0.008)
em_l2pteta.SetBinError(5,1,0.002)
em_l2pteta.SetBinError(6,1,0.005)
em_l2pteta.SetBinError(1,2,0.006)
em_l2pteta.SetBinError(2,2,0.004)
em_l2pteta.SetBinError(3,2,0.007)
em_l2pteta.SetBinError(4,2,0.005)
em_l2pteta.SetBinError(5,2,0.005)
em_l2pteta.SetBinError(6,2,0.003)
em_l2pteta.SetBinError(1,3,0.022)
em_l2pteta.SetBinError(2,3,0.004)
em_l2pteta.SetBinError(3,3,0.012)
em_l2pteta.SetBinError(4,3,0.005)
em_l2pteta.SetBinError(5,3,0.002)
em_l2pteta.SetBinError(6,3,0.007)
em_l2pteta.SetBinError(1,4,0.007)
em_l2pteta.SetBinError(2,4,0.017)
em_l2pteta.SetBinError(3,4,0.003)
em_l2pteta.SetBinError(4,4,0.007)
em_l2pteta.SetBinError(5,4,0.010)
em_l2pteta.SetBinError(6,4,0.008)

mm_l1pteta = TH2D('h2D_SF_mumu_lep1pteta', 'h2D_SF_mumu_lep1pteta', 6, tdl1ptbin, 4, tdlepetabin)
mm_l1pteta.Sumw2()
mm_l1pteta.SetStats(0)
mm_l1pteta.GetXaxis().SetTitle('Leading Lepton P_{T} [GeV]')
mm_l1pteta.GetYaxis().SetTitle('Leading Lepton #||{#eta}')
mm_l1pteta.SetTitle('')

mm_l2pteta = TH2D('h2D_SF_mumu_lep2pteta','h2D_SF_mumu_lep2pteta',6,tdl2ptbin,4,tdlepetabin)
mm_l2pteta.Sumw2()
mm_l2pteta.GetXaxis().SetTitle('Subleading Lepton P_{T} [GeV]')
mm_l2pteta.GetYaxis().SetTitle('Subleading Lepton #||{#eta}')
mm_l2pteta.SetStats(0)
mm_l2pteta.SetTitle('')

mm_l1pteta.SetBinContent(1,1,0.998)
mm_l1pteta.SetBinContent(2,1,0.969)
mm_l1pteta.SetBinContent(3,1,0.988)
mm_l1pteta.SetBinContent(4,1,0.995)
mm_l1pteta.SetBinContent(5,1,0.998)
mm_l1pteta.SetBinContent(6,1,0.992)
mm_l1pteta.SetBinContent(1,2,0.989)
mm_l1pteta.SetBinContent(2,2,0.976)
mm_l1pteta.SetBinContent(3,2,1.001)
mm_l1pteta.SetBinContent(4,2,0.999)
mm_l1pteta.SetBinContent(5,2,0.988)
mm_l1pteta.SetBinContent(6,2,0.992)
mm_l1pteta.SetBinContent(1,3,0.987)
mm_l1pteta.SetBinContent(2,3,0.992)
mm_l1pteta.SetBinContent(3,3,0.991)
mm_l1pteta.SetBinContent(4,3,0.990)
mm_l1pteta.SetBinContent(5,3,0.981)
mm_l1pteta.SetBinContent(6,3,0.986)
mm_l1pteta.SetBinContent(1,4,0.969)
mm_l1pteta.SetBinContent(2,4,0.979)
mm_l1pteta.SetBinContent(3,4,0.986)
mm_l1pteta.SetBinContent(4,4,0.989)
mm_l1pteta.SetBinContent(5,4,0.991)
mm_l1pteta.SetBinContent(6,4,0.987)

mm_l1pteta.SetBinError(1,1,0.025)
mm_l1pteta.SetBinError(2,1,0.027)
mm_l1pteta.SetBinError(3,1,0.005)
mm_l1pteta.SetBinError(4,1,0.002)
mm_l1pteta.SetBinError(5,1,0.011)
mm_l1pteta.SetBinError(6,1,0.008)
mm_l1pteta.SetBinError(1,2,0.009)
mm_l1pteta.SetBinError(2,2,0.006)
mm_l1pteta.SetBinError(3,2,0.006)
mm_l1pteta.SetBinError(4,2,0.005)
mm_l1pteta.SetBinError(5,2,0.008)
mm_l1pteta.SetBinError(6,2,0.002)
mm_l1pteta.SetBinError(1,3,0.021)
mm_l1pteta.SetBinError(2,3,0.008)
mm_l1pteta.SetBinError(3,3,0.010)
mm_l1pteta.SetBinError(4,3,0.012)
mm_l1pteta.SetBinError(5,3,0.007)
mm_l1pteta.SetBinError(6,3,0.001)
mm_l1pteta.SetBinError(1,4,0.031)
mm_l1pteta.SetBinError(2,4,0.014)
mm_l1pteta.SetBinError(3,4,0.015)
mm_l1pteta.SetBinError(4,4,0.009)
mm_l1pteta.SetBinError(5,4,0.022)
mm_l1pteta.SetBinError(6,4,0.006)

mm_l2pteta.SetBinContent(1,1,0.985)
mm_l2pteta.SetBinContent(2,1,0.995)
mm_l2pteta.SetBinContent(3,1,0.999)
mm_l2pteta.SetBinContent(4,1,0.995)
mm_l2pteta.SetBinContent(5,1,0.998)
mm_l2pteta.SetBinContent(6,1,0.999)
mm_l2pteta.SetBinContent(1,2,0.990)
mm_l2pteta.SetBinContent(2,2,0.994)
mm_l2pteta.SetBinContent(3,2,0.996)
mm_l2pteta.SetBinContent(4,2,0.993)
mm_l2pteta.SetBinContent(5,2,0.984)
mm_l2pteta.SetBinContent(6,2,0.999)
mm_l2pteta.SetBinContent(1,3,0.984)
mm_l2pteta.SetBinContent(2,3,0.990)
mm_l2pteta.SetBinContent(3,3,0.996)
mm_l2pteta.SetBinContent(4,3,1.002)
mm_l2pteta.SetBinContent(5,3,0.992)
mm_l2pteta.SetBinContent(6,3,0.995)
mm_l2pteta.SetBinContent(1,4,0.979)
mm_l2pteta.SetBinContent(2,4,0.991)
mm_l2pteta.SetBinContent(3,4,0.979)
mm_l2pteta.SetBinContent(4,4,0.993)
mm_l2pteta.SetBinContent(5,4,0.995)
mm_l2pteta.SetBinContent(6,4,0.991)

mm_l2pteta.SetBinError(1,1,0.003)
mm_l2pteta.SetBinError(2,1,0.005)
mm_l2pteta.SetBinError(3,1,0.004)
mm_l2pteta.SetBinError(4,1,0.004)
mm_l2pteta.SetBinError(5,1,0.006)
mm_l2pteta.SetBinError(6,1,0.006)
mm_l2pteta.SetBinError(1,2,0.008)
mm_l2pteta.SetBinError(2,2,0.009)
mm_l2pteta.SetBinError(3,2,0.004)
mm_l2pteta.SetBinError(4,2,0.007)
mm_l2pteta.SetBinError(5,2,0.008)
mm_l2pteta.SetBinError(6,2,0.001)
mm_l2pteta.SetBinError(1,3,0.007)
mm_l2pteta.SetBinError(2,3,0.003)
mm_l2pteta.SetBinError(3,3,0.006)
mm_l2pteta.SetBinError(4,3,0.007)
mm_l2pteta.SetBinError(5,3,0.015)
mm_l2pteta.SetBinError(6,3,0.004)
mm_l2pteta.SetBinError(1,4,0.015)
mm_l2pteta.SetBinError(2,4,0.004)
mm_l2pteta.SetBinError(3,4,0.015)
mm_l2pteta.SetBinError(4,4,0.014)
mm_l2pteta.SetBinError(5,4,0.013)
mm_l2pteta.SetBinError(6,4,0.019)

c1 = TCanvas()
pad1 = TPad()
pad1.Draw()
pad1.cd()

ee_l1pteta.Draw('COLZ E TEXT')
CMSstyle.SetStyle(pad1)
pad1.SetRightMargin(0.15)
c1.SetGridx(False);
c1.SetGridy(False);
c1.SaveAs('./final_plot/ee_l1pteta.png')
c1.SaveAs('./final_plot/ee_l1pteta.pdf')
pad1.Close()

c2 = TCanvas()
pad2 = TPad()
pad2.Draw()
pad2.cd()

ee_l2pteta.Draw('COLZ E TEXT')
CMSstyle.SetStyle(pad2)
pad2.SetRightMargin(0.15)
c2.SetGridx(False);
c2.SetGridy(False);
c2.SaveAs('./final_plot/ee_l2pteta.png')
c2.SaveAs('./final_plot/ee_l2pteta.pdf')
pad2.Close()

c3 = TCanvas()
pad3 = TPad()
pad3.Draw()
pad3.cd()

em_l1pteta.Draw('COLZ E TEXT')
CMSstyle.SetStyle(pad3)
pad2.SetRightMargin(0.15)
c3.SetGridx(False);
c3.SetGridy(False);
c3.SaveAs('./final_plot/em_l1pteta.png')
c3.SaveAs('./final_plot/em_l1pteta.pdf')
pad3.Close()

c4 = TCanvas()
pad4 = TPad()
pad4.Draw()
pad4.cd()

em_l2pteta.Draw('COLZ E TEXT')
CMSstyle.SetStyle(pad4)
pad4.SetRightMargin(0.15)
c4.SetGridx(False);
c4.SetGridy(False);
c4.SaveAs('./final_plot/em_l2pteta.png')
c4.SaveAs('./final_plot/em_l2pteta.pdf')
pad4.Close()

c5 = TCanvas()
pad5 = TPad()
pad5.Draw()
pad5.cd()

mm_l1pteta.Draw('COLZ E TEXT')
CMSstyle.SetStyle(pad5)
pad5.SetRightMargin(0.15)
c5.SetGridx(False);
c5.SetGridy(False);
c5.SaveAs('./final_plot/mm_l1pteta.png')
c5.SaveAs('./final_plot/mm_l1pteta.pdf')
pad5.Close()

c6 = TCanvas()
pad6 = TPad()
pad6.Draw()
pad6.cd()

mm_l2pteta.Draw('COLZ E TEXT')
CMSstyle.SetStyle(pad6)
pad6.SetRightMargin(0.15)
c6.SetGridx(False);
c6.SetGridy(False);
c6.SaveAs('./final_plot/mm_l2pteta.png')
c6.SaveAs('./final_plot/mm_l2pteta.pdf')
pad6.Close()

r1=TFile.Open('./final_plot/TriggerSF.root','recreate')
r1.cd()
ee_l1pteta.Write()
ee_l2pteta.Write()
em_l1pteta.Write()
em_l2pteta.Write()
mm_l1pteta.Write()
mm_l2pteta.Write()
r1.Close()
